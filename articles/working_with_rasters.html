<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Working with raster objects â€¢ gslSpatial</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Working with raster objects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gslSpatial</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/assign_points.html">Assigning points to polygons</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_rasters.html">Working with raster objects</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JoleneSutton/gslSpatial/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Working with raster objects</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JoleneSutton/gslSpatial/blob/main/vignettes/working_with_rasters.Rmd" class="external-link"><code>vignettes/working_with_rasters.Rmd</code></a></small>
      <div class="d-none name"><code>working_with_rasters.Rmd</code></div>
    </div>

    
    
<p><span style="color:red"><strong>vignette under
construction</strong></span></p>
<div class="section level2">
<h2 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Make square 10 km X 10 km grid cells over the GSL</li>
<li>Summarise fishery catch data</li>
<li>Export the results as either a data frame or a SpatRaster</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JoleneSutton/gslSpatial" class="external-link">gslSpatial</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dieghernan.github.io/tidyterra/" class="external-link">tidyterra</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="make-square-grids">Make square grids<a class="anchor" aria-label="anchor" href="#make-square-grids"></a>
</h2>
<p>Use the <code>make_grid</code> function, specifying the grid cell
size (resolution). Using a resolution of 10 makes each grid cell 10 km X
10 km. The finer the resolution, the longer it will take to generate. By
default, this function generates grid cells spanning all of NAFO
3Pn4RST, and assigns the corresponding NAFO division or subdivision to
each cell.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/make_grid.html">make_grid</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Source: https://www.nafo.int</span></span>
<span><span class="co">#&gt; Assigning NAFO divisions to 3141 grid cells.</span></span>
<span><span class="co">#&gt; Processing points 1 to 1000. 14:22:20</span></span>
<span><span class="co">#&gt; Processing points 1001 to 2000. 14:22:30</span></span>
<span><span class="co">#&gt; Processing points 2001 to 3000. 14:22:43</span></span>
<span><span class="co">#&gt; Processing points 3001 to 3141. 14:22:50</span></span></code></pre></div>
<p>The resulting grid is a data frame. The coordinates are the centers
of the grid cells. Longitude and latitude coordinates are NAD83,
EPSG:4269, in decimal degrees. X and Y coordinates are NAD83, UTM zone
20N, with units in km.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "data.frame"</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="co">#&gt;             X        Y area longitude latitude nafo.assigned</span></span>
<span><span class="co">#&gt; 112  988.9978 5810.911    1 -55.83546 52.23061          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 113  998.9978 5810.911   41 -55.69022 52.22166          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 114 1008.9978 5810.911   92 -55.54506 52.21253            4R</span></span>
<span><span class="co">#&gt; 115 1018.9978 5810.911   32 -55.39998 52.20322          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 228  998.9978 5800.911   48 -55.70491 52.13248            4R</span></span>
<span><span class="co">#&gt; 229 1008.9978 5800.911  100 -55.56003 52.12338            4R</span></span></code></pre></div>
<div class="section level3">
<h3 id="plot-the-grid-showing-the-nafo-boundaries-">Plot the grid, showing the NAFO boundaries.<a class="anchor" aria-label="anchor" href="#plot-the-grid-showing-the-nafo-boundaries-"></a>
</h3>
<p>Notice that grid cells without assigned NAFO divisions have centers
that fall outside the NAFO borders.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get NAFO boundaries</span></span>
<span><span class="va">naf</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/get_shapefile.html">get_shapefile</a></span><span class="op">(</span><span class="st">'nafo.clipped'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Source: https://www.nafo.int</span></span>
<span><span class="va">naf</span><span class="op">&lt;-</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/project.html" class="external-link">project</a></span><span class="op">(</span><span class="va">naf</span>, <span class="st">'+proj=utm +zone=20 +datum=NAD83 +units=km +no_defs'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">grid</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,fill<span class="op">=</span><span class="va">nafo.assigned</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/ggspatvector.html" class="external-link">geom_spatvector</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">naf</span>,fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="working_with_rasters_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="restrict-by-location-and-depth">Restrict by location and depth<a class="anchor" aria-label="anchor" href="#restrict-by-location-and-depth"></a>
</h3>
<ul>
<li>Restrict to NAFO 4T</li>
<li>Use function <code>get_depth</code> to estimate depth in meters. Use
?gslSpatial::get_depth for details.</li>
<li>Remove grid cells with depths shallower than 5 meters.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid</span><span class="op">&lt;-</span><span class="va">grid</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">grid</span><span class="op">$</span><span class="va">nafo.assigned</span><span class="op">==</span><span class="st">"4T"</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">depth</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/get_depth.html">get_depth</a></span><span class="op">(</span><span class="va">grid</span><span class="op">$</span><span class="va">longitude</span>,<span class="va">grid</span><span class="op">$</span><span class="va">latitude</span>,<span class="st">"epsg:4269"</span><span class="op">)</span></span>
<span><span class="co">#&gt; The default argument assumes your points have crs NAD83 - EPSG:4269.</span></span>
<span><span class="co">#&gt; Assigning depths based on GEBCO_2024, www.gebco.net.</span></span>
<span><span class="va">grid</span><span class="op">$</span><span class="va">depth</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">depth</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    1169 obs. of  7 variables:</span></span>
<span><span class="co">#&gt;  $ X            : num  189 199 209 219 159 ...</span></span>
<span><span class="co">#&gt;  $ Y            : num  5481 5481 5481 5481 5471 ...</span></span>
<span><span class="co">#&gt;  $ area         : num  63 100 100 100 61 69 68 100 100 100 ...</span></span>
<span><span class="co">#&gt;  $ longitude    : num  -67.3 -67.1 -67 -66.9 -67.7 ...</span></span>
<span><span class="co">#&gt;  $ latitude     : num  49.4 49.4 49.4 49.4 49.3 ...</span></span>
<span><span class="co">#&gt;  $ nafo.assigned: chr  "4T" "4T" "4T" "4T" ...</span></span>
<span><span class="co">#&gt;  $ depth        : num  -11 -185 -289.9 -296 -35.9 ...</span></span>
<span></span>
<span><span class="va">grid</span><span class="op">&lt;-</span><span class="va">grid</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">grid</span><span class="op">$</span><span class="va">depth</span><span class="op">&gt;</span><span class="op">(</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">grid</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,fill<span class="op">=</span><span class="va">depth</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/ggspatvector.html" class="external-link">geom_spatvector</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">naf</span>,fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="working_with_rasters_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="get-catch-data">Get catch data<a class="anchor" aria-label="anchor" href="#get-catch-data"></a>
</h2>
<div class="section level3">
<h3 id="plot-raw-data">Plot raw data<a class="anchor" aria-label="anchor" href="#plot-raw-data"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="summarise">Summarise<a class="anchor" aria-label="anchor" href="#summarise"></a>
</h2>
<div class="section level3">
<h3 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h3>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jolene T. Sutton, Lysandre Landry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
